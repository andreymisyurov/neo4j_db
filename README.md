## Project: analise_db_neo4j

## intership graph database. test_task

### Подготавливаем софт
- устанавливаем neo4j и GDS из репозитория https://github.com/neo4j билдим согласно документации в репозитории
- библиотеки pandas, neo4j, networkx пакетным менеджером pip
- ipynb

### Парсим данные из csv в neo4j
- должен быть запущен neo4j на 7687 порту
- имя файла `data_test.csv` должен лежать в одной директории со скриптом
- запускаем скрипт, переходим на localhost:7474, авторизуемся, проверяем

### Запросы neo4j на языке Cypher
Можно писать запросы в интерактивном режиме терминала Cypher Shell командой `cypher-shell`, авторизуемся
Попросит ввести `user-name` и `password`<br>
Или же можно направлять скрипты `.cypher` в Cypher Shell таким образом `cypher-shell < SCRIPT_NAME.cypher`<br>

Написанные мной скрипты можно найти в директории request-scripts.<br>
Там присутствуют скрипты такие как:
- Вывод ФИО участников и событий, в которых принимали участие участники с одинаковым именем
- Поиск и вывод событий, в которых участвовали участники с фамилиями, начинающимися на одинаковую букву.
- Топ 10 участников, которые принимали участие в максимальном количестве встреч
- Поиск встреч, в которых принимали участие 4 и более участников
- Вывод списка участников, по заданным id встречи
- Вывод списка встреч, в которых участвовал определенный участник
- Вывод всех участников, с определенным именем


### Выявление и анализ сложных сообществ
- Начал анализ с выявления сообществ, вывел в читабельном json. Изучив данные визуально заметил и обратил внимание, что
  элементов в сообщество 221 больше чаще в остальных сообществах
- Далее для поиска сложных сообществ я вывел количество элементов в каждом сообществе, предварительно отсортировав при
  помощи библиотеки Count
- Следующим шагом отрисовал граф только сложных сообществ, удалив из графа узлы, которые состоят в "простых"
  сообществах (посчитал сообщества простыми, если оно имеет 3 и менее элементов).
- На выведенном графе видны элементы сложных сообществ. Узлы "event" покрашены в красный цвет, а узлы "participant"
  окрашены в синий цвет.
- Посмотрев на визуальное представление графа заметил, что некоторые участники принимали участия во множестве встреч,
  некоторые встречались несколько раз. Также были встречи в которых участвовали 4 участника.
  ![ANALISE](misc/graph.png)


### Rest-API
Для реализации этой части задания использовал фреймворк Flask.<br>
Чтобы запустить сервер, необходимо выполнить в терминале `python3 flask-rest.py`<br>

Реализовано два способа отправки POST запроса.
- простой UI интерфейс с возможностью ввода данных в форму<br>
  `http://127.0.0.1:5000/search`<br>
- или curl-запрос из терминала со строкой для поиска `curl -X POST -H "Content-Type: text/plain" -d "Галчевская Карина
  Владимировна" http://localhost:5000/search`<br>


### Контейнеризация
Так как осталось время, решил перенести базу данных и веб-сервер в Docker-контейнеры.<br>
Чтобы запустить контейнеры, достаточно прописать `docker-compose up` из основной директории проекта<br>
Затем запускаем скрипты из jupyter note и проверяем работоспособность<br>
